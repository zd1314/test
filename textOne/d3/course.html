<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		.tooltip {
			position: absolute;
			height: auto;
			font-family: simsun;
			font-size: 14px;
			text-align: center;
			color: white;
			border-width: 2px solid black;
			background-color: black;
			border-radius: 5px;
		}

		.tooltip:after {
			content: '';
			position: absolute;
			bottom: 100%;
			left: 20%;
			margin-left: -8px;
			width: 0;
			height: 0;
			border-bottom: 12px solid black;
			border-right: 12px solid transparent;
			border-left: 12px solid transparent;
		}
	</style>
</head>

<body>
	<div id='cont'></div>
	<script src='./d3.v4.min.js'></script>
	<script>
		function Con() {
			this.cont = document.getElementById('cont')
			this.init()
		}
		Con.prototype = {
			arc: function (r, R, start, end) {
				let arc = d3.arc()
					.innerRadius(r)
					.outerRadius(R)
					.startAngle(start)
					.endAngle(end);
				return arc();
			},
			init: function () {
				this.width = 500;
				this.height = 500;
				this.r = 80, this.R = 90;
				this.data = [40, 67, 70, 38];
				this.color = ['#0285fb', '#11cbf6', '#04f28c', '#ffee2e']
			},
			creat: function () {
				let me = this;
				me.arc()
				me.svg = d3.select(me.cont).append('svg');
				me.svg.attr('width', me.width);
				me.svg.attr('height', me.height);
				let gbox = me.svg.append('g')
					.attr('id', 'g-box')
					.attr("transform", `translate(${me.width / 2} ${me.height / 2})`)
				gbox.selectAll('path').data(me.data).enter().append('path')
					.attr('d', function (d, i) {
						let scale = d3.scaleLinear()
							.domain([d3.min(me.data), d3.max(me.data)])
							.range([1, 10])
						return me.arc(125 - 15 * (i + 1) - 15 * i, 125 - 15 * i - 15 * i, Math.PI * 2, Math.PI / 2.5)
					})
					.style('fill', function (d, i) {
						return me.color[i]
					})
					.on('mouseover', function () {
						console.log(88)
					})
				let tooltip = me.svg.append("div")
					.attr('width', 300)
					.attr('height', 100)
					.attr("class", "tooltip")
					.attr('transform', 'translate(250,250)')
					.style("opacity", 0.0);
				gbox.selectAll('text').data(me.data).enter().append('text')
					.text(function (d, i) {
						return '厕所' + i + ':' + d + '%'
					})
					.attr('x', function (d, i) {
						return 10
					})
					.attr('dy', function (d, i) {
						return -28 * (i + 1)
					})
					.attr('fill', 'blue')
			}
		}
		let aa = new Con()
		aa.creat()
	</script>
</body>

</html>